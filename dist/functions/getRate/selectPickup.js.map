{"version":3,"file":"selectPickup.js","names":["selectPickup","recipientPhone","textMessage","message_id","res","connection","query","err","rows","fields","latest_question","spdAction","Whatsapp","sendSimpleButtons","message","listOfButtons","id","title","map","category","markMessageAsRead","sendStatus"],"sources":["../../../src/functions/getRate/selectPickup.js"],"sourcesContent":["'use strict';\nimport Whatsapp from '../../config/whatsapp';\nimport connection from '../../config/db';\nimport { spdAction } from '../../routes';\n\nexport default async function selectPickup(recipientPhone, textMessage, message_id, res) {\n  connection.query(\n    `SELECT latest_question FROM whatsapp_cloud WHERE phone_no = '${recipientPhone}'`,\n    async (err, rows, fields) => {\n      if (err)\n        throw err;\n      const latest_question = rows[0].latest_question;\n\n      if (latest_question === 'select pickup destination') {\n        spdAction(textMessage, recipientPhone);\n\n        // send \"select pickup destination\" + pickup destinations (emoji list)\n        await Whatsapp.sendSimpleButtons({\n          message: `Select the type of container preferred`,\n          recipientPhone: recipientPhone,\n          message_id,\n          listOfButtons: [\n            { id: 20, title: '20ft' },\n            { id: 40, title: '40ft' },\n          ].map((category) => ({\n            title: category.title,\n            id: `container_${category.id}`,\n          })),\n        });\n\n        await Whatsapp.markMessageAsRead({\n          message_id,\n        });\n        return res.sendStatus(200);\n      }\n    }\n  );\n}\n"],"mappings":"AAAA,YAAY;;AAAC;EAAA;AAAA;AAAA;AACb;AACA;AACA;AAAyC;AAAA;AAAA,+CAFzC;AAAA;AAAA;AAAA,SAI8BA,YAAY;EAAA;AAAA;AAAA;EAAA,2EAA3B,kBAA4BC,cAAc,EAAEC,WAAW,EAAEC,UAAU,EAAEC,GAAG;IAAA;MAAA;QAAA;UACrFC,cAAU,CAACC,KAAK,wEACkDL,cAAc;YAAA,sEAC9E,iBAAOM,GAAG,EAAEC,IAAI,EAAEC,MAAM;cAAA;cAAA;gBAAA;kBAAA;oBAAA,KAClBF,GAAG;sBAAA;sBAAA;oBAAA;oBAAA,MACCA,GAAG;kBAAA;oBACLG,eAAe,GAAGF,IAAI,CAAC,CAAC,CAAC,CAACE,eAAe;oBAAA,MAE3CA,eAAe,KAAK,2BAA2B;sBAAA;sBAAA;oBAAA;oBACjD,IAAAC,iBAAS,EAACT,WAAW,EAAED,cAAc,CAAC;;oBAEtC;oBAAA;oBAAA,OACMW,oBAAQ,CAACC,iBAAiB,CAAC;sBAC/BC,OAAO,0CAA0C;sBACjDb,cAAc,EAAEA,cAAc;sBAC9BE,UAAU,EAAVA,UAAU;sBACVY,aAAa,EAAE,CACb;wBAAEC,EAAE,EAAE,EAAE;wBAAEC,KAAK,EAAE;sBAAO,CAAC,EACzB;wBAAED,EAAE,EAAE,EAAE;wBAAEC,KAAK,EAAE;sBAAO,CAAC,CAC1B,CAACC,GAAG,CAAC,UAACC,QAAQ;wBAAA,OAAM;0BACnBF,KAAK,EAAEE,QAAQ,CAACF,KAAK;0BACrBD,EAAE,sBAAeG,QAAQ,CAACH,EAAE;wBAC9B,CAAC;sBAAA,CAAC;oBACJ,CAAC,CAAC;kBAAA;oBAAA;oBAAA,OAEIJ,oBAAQ,CAACQ,iBAAiB,CAAC;sBAC/BjB,UAAU,EAAVA;oBACF,CAAC,CAAC;kBAAA;oBAAA,iCACKC,GAAG,CAACiB,UAAU,CAAC,GAAG,CAAC;kBAAA;kBAAA;oBAAA;gBAAA;cAAA;YAAA,CAE7B;YAAA;cAAA;YAAA;UAAA,IACF;QAAC;QAAA;UAAA;MAAA;IAAA;EAAA,CACH;EAAA;AAAA"}