{"version":3,"file":"selectContainerType.js","names":["selectContainerType","typeOfMsg","incomingMessage","recipientPhone","message_id","res","includes","button_reply","id","stcAction","Whatsapp","sendText","message","markMessageAsRead","sendStatus","flag","connection","query","err","fields","Boolean"],"sources":["../../../src/functions/getRate/selectContainerType.js"],"sourcesContent":["'use strict';\nimport Whatsapp from '../../config/whatsapp';\n\nexport default async function selectContainerType(typeOfMsg, incomingMessage, recipientPhone, message_id, res) {\n\n  if (typeOfMsg === 'simple_button_message' &&\n    ['container_20', 'container_40'].includes(\n      incomingMessage.button_reply.id\n    )) {\n    stcAction(incomingMessage.button_reply.id, recipientPhone);\n\n    // send \"select destination region\" + destination regions (emoji list)\n    await Whatsapp.sendText({\n      recipientPhone: recipientPhone,\n      message: 'What number of containers do you want?',\n    });\n    await Whatsapp.markMessageAsRead({\n      message_id,\n    });\n    return res.sendStatus(200);\n  }\n\n}\n\nfunction stcAction(message, recipientPhone) {\n  let flag = 0;\n  connection.query(\n      `UPDATE whatsapp_cloud SET container_type = '${message}' WHERE phone_no = '${recipientPhone}';`,\n      (err, res, fields) => {\n          if (err) flag = 1;\n      }\n  );\n\n  connection.query(\n      `UPDATE whatsapp_cloud SET latest_question = 'number of containers' WHERE phone_no = '${recipientPhone}';`,\n      (err, res, fields) => {\n          if (err) flag = 1;\n      }\n  );\n  return !Boolean(flag);\n}"],"mappings":"AAAA,YAAY;;AAAC;EAAA;AAAA;AAAA;AACb;AAA6C;AAAA;AAAA,+CAA7C;AAAA;AAAA;AAAA,SAE8BA,mBAAmB;EAAA;AAAA;AAAA;EAAA,kFAAlC,iBAAmCC,SAAS,EAAEC,eAAe,EAAEC,cAAc,EAAEC,UAAU,EAAEC,GAAG;IAAA;MAAA;QAAA;UAAA,MAEvGJ,SAAS,KAAK,uBAAuB,IACvC,CAAC,cAAc,EAAE,cAAc,CAAC,CAACK,QAAQ,CACvCJ,eAAe,CAACK,YAAY,CAACC,EAAE,CAChC;YAAA;YAAA;UAAA;UACDC,SAAS,CAACP,eAAe,CAACK,YAAY,CAACC,EAAE,EAAEL,cAAc,CAAC;;UAE1D;UAAA;UAAA,OACMO,oBAAQ,CAACC,QAAQ,CAAC;YACtBR,cAAc,EAAEA,cAAc;YAC9BS,OAAO,EAAE;UACX,CAAC,CAAC;QAAA;UAAA;UAAA,OACIF,oBAAQ,CAACG,iBAAiB,CAAC;YAC/BT,UAAU,EAAVA;UACF,CAAC,CAAC;QAAA;UAAA,iCACKC,GAAG,CAACS,UAAU,CAAC,GAAG,CAAC;QAAA;QAAA;UAAA;MAAA;IAAA;EAAA,CAG7B;EAAA;AAAA;AAED,SAASL,SAAS,CAACG,OAAO,EAAET,cAAc,EAAE;EAC1C,IAAIY,IAAI,GAAG,CAAC;EACZC,UAAU,CAACC,KAAK,uDACmCL,OAAO,iCAAuBT,cAAc,SAC3F,UAACe,GAAG,EAAEb,GAAG,EAAEc,MAAM,EAAK;IAClB,IAAID,GAAG,EAAEH,IAAI,GAAG,CAAC;EACrB,CAAC,CACJ;EAEDC,UAAU,CAACC,KAAK,gGAC4Ed,cAAc,SACtG,UAACe,GAAG,EAAEb,GAAG,EAAEc,MAAM,EAAK;IAClB,IAAID,GAAG,EAAEH,IAAI,GAAG,CAAC;EACrB,CAAC,CACJ;EACD,OAAO,CAACK,OAAO,CAACL,IAAI,CAAC;AACvB"}